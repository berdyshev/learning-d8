<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">

  <title>Learning Drupal 8</title>

  <link rel="shortcut icon" href="favicon.ico" type="image/vnd.microsoft.icon" />

  <meta name="description" content="Learning Drupal 8 on dummy module">
  <meta name="author" content="Artem Berdyshev (BerdArt)">

  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <link rel="stylesheet" href="css/reveal.min.css">
  <link rel="stylesheet" href="css/theme/asphalt-orange.css" id="theme">

  <!-- For syntax highlighting -->
  <link rel="stylesheet" href="lib/css/zenburn.css">

  <!-- If the query includes 'print-pdf', use the PDF print sheet -->
  <script>
     document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
  </script>

	<!--[if lt IE 9]>
	<script src="lib/js/html5shiv.js"></script>
	<![endif]-->
</head>

<body>

	<div class="reveal">

		<!-- Any section element inside of this container is displayed as a slide -->
        <div class="slides">
            <section>
                <h1 class="absolute-element">Learning Drupal 8</h1>
            </section>
            <section>
                <h2>New directory structure</h2>
                <ul>
                    <li>Do not touch /core directory</li>
                    <li>Modules should be stored in /modules</li>
                    <li>Themes should be stored in /themes</li>
                    <li>You still can use sites/[site-alias] directory for multisiting</li>
                </ul>
            </section>
            <section>
                <h2>Define you module</h2>
                <ul>
                    <li>Info file in YAML format</li>
                    <li>Remove all 'files' references</li>
                    <li>Add <code>type: module</code> item</li>
                </ul>
            </section>

            <!-- ROUTES -->
            <section>
                <section>
                    <h2>Routes</h2>
                    <ul>
                        <li>mymodule.routing.yml</li>
                        <li>Path to controller (form, etc) mapping</li>
                        <li>Parameters (cast argument to certain type)</li>
                        <li>Access checks</li>
                    </ul>
                </section>
                <section>
                <h2>Basic routes</h2>
                    <p>7.x</p>
<pre><code>function mymodule_menu() {
  $items['mymodule'] = array(
    'title' => 'MyModule list',
    'page callback' => 'mymodule_list',
    'access arguments' => 'view mymodule list',
    'type' => MENU_CALLBACK,
   ); 
}</code></pre>
                    <p>8.x</p>
<pre><code>mymodule.list:
  pattern: '/mymodule'
  defaults:
    _content: '\Drupal\mymodule\Controller\MymoduleController::list'
  requirements:
    _permission: 'view mymodule list'</code></pre>
                </section>
                
                <section>
                    <h2>Param converter</h2>
                    <p>Convert {param} to something</p>
                    <p>Example: node/1 => $node</p>
<pre><code>paramconverter_test_node_set_parent:
  pattern: '/paramconverter_test/node/{node}/set/parent/{parent}'
  requirements:
    _access: 'TRUE'
  defaults:
    _content: '\Drupal\paramconverter_test\TestControllers::testNodeSetParent'
  options:
    parameters:
      parent:
        type: 'entity:node'</code></pre>
                    <p>You can define custom converter by defining service with tag 'paramconverter'</p>
                </section>
            </section>

            <!-- ACCESS CHECK -->
            <section>
                <section>
                    <h2>Access check</h2>
                    <ul>
                        <li>Routes define requirements</li>
                        <li>Multiple access checks can run on a single route</li>
                        <li>Mode: ALL or ANY</li>
                        <li>Re-usable access checkers</li>
                        <li>Custom checker: define service with tag 'access check' which implements <code>StaticAccessCheckInterface</code></li>
                    </ul>
                </section>
                <section>
                    <h2>Example</h3>
<pre><code>edit_entity_save:
  pattern: '/edit/entity/{entity_type}/{entity}'
  defaults:
    _controller: '\Drupal\edit\EditController::entitySave'
  options:
    _access_mode: 'ALL'
  requirements:
    _permission: 'access in-place editing'
    _access_edit_entity: 'TRUE'</code></pre>
                </section>
                <section>
                    <h2>Re-usable requirements</h2>
                    <p>Check if a user has a permission</p>
                    <pre><code>_permission: 'my permission name'</code></pre>
                    <p>Check if a user has a role</p>
                    <pre><code>_role: 'role1+role2' (AND)
_role: 'role1, role2' (OR)</code></pre>
                    <p>Check if user is logged in</p>
                    <pre><code>_user_is_logged_in: 'TRUE'</code></pre>
                    <p>Allow everyone</p>
                    <pre><code>_access: 'TRUE'</code></pre>
                </section>
            </section>

            <!-- MENU LINKS -->
            <section>
                <section>
                    <h2>Menu links</h2>
                    <p>New <code>hook_default_menu_links()</code> (not yet in core: <a href="https://drupal.org/node/2047633">#2047633</a>)</p>
                    <p>Until that issue is committed: keep hook_menu()</p>
                    <p>Simple structure: link path, title, description, parent</p>
                </section>
                <section>
                    <h2>Example</h2>
<pre><code>function node_menu() {
    $items['admin/structure/types'] = array(
    'title' => 'Content types',
    'description' => 'Manage content types, including default status, front page promotion, comment settings, etc.',
    'route_name' => 'node.overview_types',
  );
  $items['admin/structure/types/list'] = array(
    'title' => 'List',
    'type' => MENU_DEFAULT_LOCAL_TASK,
  );
return $items;
} </code></pre>
                </section>
            </section>

            <!-- TITLE -->
            <section>
                <h2>Title</h2>
                <p>drupal_set_title() will gone soon</p>
                <h3>Replacement</h3>
                <ul>
                    <li>_title in route definition</li>
                    <li>_title_callback in route definition</li>
                    <li>#title in render arrays (highest priority)</li>
                </ul>
                <p>See more examples in this <a href="https://drupal.org/node/2067859">change notice</a></p>
            </section>

            <!-- CONTROLLERS -->
            <section>
                <section>
                    <h2>Controllers</h2>
                    <p>Handle the request and return response</p>
                </section>
                <section>
                    <h2>Example</h2>
                    <p>7.x</p>
<pre><code>function mymodule_page() {
return t('My module list page');
}</code></pre></p>
                <p>8.x</p>
                <p>
<pre><code>class MymoduleController extends ControllerBase {
    public function list() {
        return $this->t('My module list page');
    }
}</code></pre>
                </section>
                <section>
                    <h2>Responses</h2>
                    <ul>
                        <li>Response (default, just return build array or string)</li>
                        <li>JsonResponse (instead of <code>drupal_json_output()</code>)</li>
                        <li>AjaxResponse</li>
                        <li>RedirectResponse (instead of <code>drupal_goto()</code>)</li>
                    </ul>
                    <h3>Example</h3>
<pre><code>class MymoduleController extends ControllerBase {
    public function list() {
        $data = array('message' => $this->t('My module list page'));
        return new JsonResponse($data);
    }
}</code></pre>                    
                </section>
            </section>
        </div>

    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.min.js"></script>

    <script>

		// Full list of configuration options available here:
		// https://github.com/hakimel/reveal.js#configuration
		Reveal.initialize({
			controls: true,
			progress: true,
			history: true,
			center: true,

			theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
			transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

			// Optional libraries used to extend on reveal.js
			dependencies: [
           { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
           { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
           { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
           { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
           { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
           { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
           ]
       });

    </script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-44541841-1', 'berdart.github.io');
      ga('send', 'pageview');

    </script>

</body>
</html>
